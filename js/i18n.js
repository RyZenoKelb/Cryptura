// ============= I18N.JS - Syst√®me de traduction internationalization =============

class InternationalizationManager {
    constructor() {
        this.currentLanguage = localStorage.getItem('obscura-language') || 'fr';
        this.translations = {};
        this.loadTranslations();
        
        console.log('üåç Syst√®me i18n initialis√©:', this.currentLanguage);
    }

    loadTranslations() {
        this.translations = {
            fr: {
                // Header & Navigation
                'app.title': 'Obscura - St√©ganographie Ultra-S√©curis√©e',
                'header.tagline': 'St√©ganographie Avanc√©e',
                'header.status': 'Syst√®me actif',
                'nav.encode': 'Encoder',
                'nav.decode': 'D√©coder',
                'nav.ultracrypte': 'UltraCrypte',
                'nav.help': 'Documentation',

                // Encode Panel
                'encode.title': 'Encodage S√©curis√©',
                'encode.subtitle': 'Dissimulation avanc√©e de donn√©es dans vos fichiers multim√©dias avec chiffrement de niveau militaire',
                'encode.carrier.title': 'Fichier Porteur',
                'encode.carrier.description': 'Glissez votre m√©dia ou cliquez pour s√©lectionner',
                'encode.carrier.types': 'Images ‚Ä¢ Audio ‚Ä¢ Vid√©o ‚Ä¢ Documents',
                'encode.secret.title': 'Contenu Secret',
                'encode.secret.description': 'Message ou fichier √† dissimuler',
                'encode.secret.placeholder': 'Votre message confidentiel...',
                'encode.secret.file': 'Ou s√©lectionner un fichier :',
                'encode.method.label': 'M√©thode de St√©ganographie',
                'encode.crypto.label': 'Niveau de Chiffrement',
                'encode.crypto.none': 'Aucun chiffrement',
                'encode.password.label': 'Mot de passe de chiffrement',
                'encode.password.placeholder': 'Phrase de passe s√©curis√©e',
                'encode.options.label': 'Options Avanc√©es',
                'encode.options.compress': 'Compression des donn√©es',
                'encode.options.noise': 'Ajout de bruit cryptographique',
                'encode.options.multilayer': 'Protection multi-couches',
                'encode.button.start': 'Lancer l\'encodage',
                'encode.button.reset': 'R√©initialiser',
                'encode.result.title': 'Encodage R√©ussi',
                'encode.result.filename': 'Fichier g√©n√©r√© :',
                'encode.result.size': 'Taille finale :',
                'encode.result.method': 'M√©thode utilis√©e :',
                'encode.button.download': 'T√©l√©charger le r√©sultat',

                // Decode Panel
                'decode.title': 'Extraction & Analyse',
                'decode.subtitle': 'D√©tection et extraction intelligente de donn√©es cach√©es avec d√©chiffrement automatique',
                'decode.upload.title': 'Fichier √† Analyser',
                'decode.upload.description': 'S√©lectionnez le fichier suspect ou encod√©',
                'decode.upload.types': 'Tous formats support√©s',
                'decode.password.label': 'Mot de passe de d√©chiffrement',
                'decode.password.placeholder': 'Phrase de passe (si chiffr√©)',
                'decode.detection.label': 'Mode de D√©tection',
                'decode.detection.auto': 'D√©tection Automatique',
                'decode.detection.force.lsb': 'Forcer LSB',
                'decode.detection.force.metadata': 'Forcer M√©tadonn√©es',
                'decode.detection.force.audio': 'Forcer Audio',
                'decode.detection.brute': 'Force Brute (exhaustif)',
                'decode.button.extract': 'Extraire les donn√©es',
                'decode.button.analyze': 'Analyse forensique',
                'decode.result.title': 'Donn√©es Extraites',
                'decode.result.method': 'M√©thode d√©tect√©e :',
                'decode.result.size': 'Taille extraite :',
                'decode.result.crypto': 'Type de chiffrement :',
                'decode.button.save': 'Sauvegarder l\'extraction',

                // UltraCrypte Panel
                'ultra.title': 'UltraCrypte‚Ñ¢',
                'ultra.subtitle': 'Chiffrement de niveau militaire avec r√©sistance post-quantique',
                'ultra.features.title': 'Technologies Avanc√©es',
                'ultra.features.postquantum': 'Chiffrement post-quantique certifi√©',
                'ultra.features.chaos': 'Algorithmes chaotiques propri√©taires',
                'ultra.features.differential': 'Protection contre l\'analyse diff√©rentielle',
                'ultra.features.sidechannel': 'R√©sistance aux attaques par canaux cach√©s',
                'ultra.features.noise': 'Masquage par bruit cryptographique',
                'ultra.features.deniable': 'D√©ni plausible int√©gr√©',
                'ultra.complexity.label': 'Niveau de Complexit√©',
                'ultra.complexity.standard': 'Standard (Rapide)',
                'ultra.complexity.enhanced': 'Renforc√© (√âquilibr√©)',
                'ultra.complexity.paranoid': 'Parano√Øaque (Maximum)',
                'ultra.masterkey.label': 'Phrase de passe ma√Ætresse',
                'ultra.masterkey.placeholder': 'Phrase longue et complexe requise...',
                'ultra.options.stealth': 'Mode furtif maximum',
                'ultra.options.deniable': 'D√©ni plausible activ√©',
                'ultra.options.volatile': 'Protection anti-dump m√©moire',

                // Help Panel
                'help.title': 'Documentation',
                'help.subtitle': 'Guide complet d\'utilisation d\'Obscura et meilleures pratiques de s√©curit√©',
                'help.encode.title': 'Guide d\'Encodage',
                'help.decode.title': 'Guide d\'Extraction',
                'help.ultra.title': 'UltraCrypte‚Ñ¢ Advanced',
                'help.practices.title': 'Meilleures Pratiques',

                // Footer
                'footer.copyright': '¬© 2024 Obscura',
                'footer.subtitle': 'St√©ganographie Professionnelle',
                'footer.mode': 'Mode Hors-ligne',
                'footer.files': 'fichiers trait√©s',

                // Messages & States
                'message.welcome': 'Bienvenue dans Obscura - St√©ganographie Ultra-S√©curis√©e',
                'message.encoding': 'Encodage en cours...',
                'message.decoding': 'Analyse en cours...',
                'message.loading': 'Traitement en cours...',
                'message.success.download': 'Fichier t√©l√©charg√© avec succ√®s!',
                'message.success.save': 'Donn√©es extraites sauvegard√©es!',
                'message.error.nocarrier': 'Veuillez s√©lectionner un fichier porteur',
                'message.error.nosecret': 'Veuillez entrer un message ou s√©lectionner un fichier secret',
                'message.error.nopassword': 'Un mot de passe est requis pour le chiffrement',
                'message.error.nofile': 'Veuillez s√©lectionner un fichier √† d√©coder',

                // Theme & Settings
                'settings.theme.light': 'Mode clair',
                'settings.theme.dark': 'Mode sombre',
                'settings.language': 'Langue',
                'settings.language.fr': 'Fran√ßais',
                'settings.language.en': 'English'
            },
            
            en: {
                // Header & Navigation
                'app.title': 'Obscura - Ultra-Secure Steganography',
                'header.tagline': 'Advanced Steganography',
                'header.status': 'System active',
                'nav.encode': 'Encode',
                'nav.decode': 'Decode',
                'nav.ultracrypte': 'UltraCrypt',
                'nav.help': 'Documentation',

                // Encode Panel
                'encode.title': 'Secure Encoding',
                'encode.subtitle': 'Advanced data concealment in your multimedia files with military-grade encryption',
                'encode.carrier.title': 'Carrier File',
                'encode.carrier.description': 'Drag your media or click to select',
                'encode.carrier.types': 'Images ‚Ä¢ Audio ‚Ä¢ Video ‚Ä¢ Documents',
                'encode.secret.title': 'Secret Content',
                'encode.secret.description': 'Message or file to hide',
                'encode.secret.placeholder': 'Your confidential message...',
                'encode.secret.file': 'Or select a file:',
                'encode.method.label': 'Steganography Method',
                'encode.crypto.label': 'Encryption Level',
                'encode.crypto.none': 'No encryption',
                'encode.password.label': 'Encryption password',
                'encode.password.placeholder': 'Secure passphrase',
                'encode.options.label': 'Advanced Options',
                'encode.options.compress': 'Data compression',
                'encode.options.noise': 'Add cryptographic noise',
                'encode.options.multilayer': 'Multi-layer protection',
                'encode.button.start': 'Start encoding',
                'encode.button.reset': 'Reset',
                'encode.result.title': 'Encoding Successful',
                'encode.result.filename': 'Generated file:',
                'encode.result.size': 'Final size:',
                'encode.result.method': 'Method used:',
                'encode.button.download': 'Download result',

                // Decode Panel
                'decode.title': 'Extraction & Analysis',
                'decode.subtitle': 'Intelligent detection and extraction of hidden data with automatic decryption',
                'decode.upload.title': 'File to Analyze',
                'decode.upload.description': 'Select the suspect or encoded file',
                'decode.upload.types': 'All formats supported',
                'decode.password.label': 'Decryption password',
                'decode.password.placeholder': 'Passphrase (if encrypted)',
                'decode.detection.label': 'Detection Mode',
                'decode.detection.auto': 'Automatic Detection',
                'decode.detection.force.lsb': 'Force LSB',
                'decode.detection.force.metadata': 'Force Metadata',
                'decode.detection.force.audio': 'Force Audio',
                'decode.detection.brute': 'Brute Force (exhaustive)',
                'decode.button.extract': 'Extract data',
                'decode.button.analyze': 'Forensic analysis',
                'decode.result.title': 'Extracted Data',
                'decode.result.method': 'Detected method:',
                'decode.result.size': 'Extracted size:',
                'decode.result.crypto': 'Encryption type:',
                'decode.button.save': 'Save extraction',

                // UltraCrypte Panel
                'ultra.title': 'UltraCrypt‚Ñ¢',
                'ultra.subtitle': 'Military-grade encryption with post-quantum resistance',
                'ultra.features.title': 'Advanced Technologies',
                'ultra.features.postquantum': 'Certified post-quantum encryption',
                'ultra.features.chaos': 'Proprietary chaotic algorithms',
                'ultra.features.differential': 'Protection against differential analysis',
                'ultra.features.sidechannel': 'Resistance to side-channel attacks',
                'ultra.features.noise': 'Cryptographic noise masking',
                'ultra.features.deniable': 'Integrated plausible deniability',
                'ultra.complexity.label': 'Complexity Level',
                'ultra.complexity.standard': 'Standard (Fast)',
                'ultra.complexity.enhanced': 'Enhanced (Balanced)',
                'ultra.complexity.paranoid': 'Paranoid (Maximum)',
                'ultra.masterkey.label': 'Master passphrase',
                'ultra.masterkey.placeholder': 'Long and complex phrase required...',
                'ultra.options.stealth': 'Maximum stealth mode',
                'ultra.options.deniable': 'Plausible deniability enabled',
                'ultra.options.volatile': 'Anti-memory dump protection',

                // Help Panel
                'help.title': 'Documentation',
                'help.subtitle': 'Complete guide to using Obscura and security best practices',
                'help.encode.title': 'Encoding Guide',
                'help.decode.title': 'Extraction Guide',
                'help.ultra.title': 'UltraCrypt‚Ñ¢ Advanced',
                'help.practices.title': 'Best Practices',

                // Footer
                'footer.copyright': '¬© 2024 Obscura',
                'footer.subtitle': 'Professional Steganography',
                'footer.mode': 'Offline Mode',
                'footer.files': 'files processed',

                // Messages & States
                'message.welcome': 'Welcome to Obscura - Ultra-Secure Steganography',
                'message.encoding': 'Encoding in progress...',
                'message.decoding': 'Analysis in progress...',
                'message.loading': 'Processing...',
                'message.success.download': 'File downloaded successfully!',
                'message.success.save': 'Extracted data saved!',
                'message.error.nocarrier': 'Please select a carrier file',
                'message.error.nosecret': 'Please enter a message or select a secret file',
                'message.error.nopassword': 'A password is required for encryption',
                'message.error.nofile': 'Please select a file to decode',

                // Theme & Settings
                'settings.theme.light': 'Light mode',
                'settings.theme.dark': 'Dark mode',
                'settings.language': 'Language',
                'settings.language.fr': 'Fran√ßais',
                'settings.language.en': 'English'
            }
        };
    }

    t(key, params = {}) {
        let translation = this.translations[this.currentLanguage]?.[key] || key;
        
        // Simple parameter replacement
        Object.keys(params).forEach(param => {
            translation = translation.replace(`{${param}}`, params[param]);
        });
        
        return translation;
    }

    setLanguage(language) {
        if (this.translations[language]) {
            this.currentLanguage = language;
            localStorage.setItem('obscura-language', language);
            this.updateInterface();
            console.log('üåç Langue chang√©e:', language);
        }
    }

    getCurrentLanguage() {
        return this.currentLanguage;
    }

    getSupportedLanguages() {
        return Object.keys(this.translations);
    }

    updateInterface() {
        // Update all elements with data-i18n attribute
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            const translation = this.t(key);
            
            if (element.tagName === 'INPUT' && (element.type === 'text' || element.type === 'password')) {
                element.placeholder = translation;
            } else if (element.tagName === 'TEXTAREA') {
                element.placeholder = translation;
            } else {
                element.textContent = translation;
            }
        });

        // Update title
        document.title = this.t('app.title');

        // Update select options
        document.querySelectorAll('[data-i18n-options]').forEach(select => {
            const options = select.querySelectorAll('option[data-i18n]');
            options.forEach(option => {
                const key = option.getAttribute('data-i18n');
                option.textContent = this.t(key);
            });
        });

        // Trigger custom event for complex components
        document.dispatchEvent(new CustomEvent('languageChanged', {
            detail: { language: this.currentLanguage }
        }));
    }
}

// Export for global use
if (typeof module !== 'undefined' && module.exports) {
    module.exports = InternationalizationManager;
}
